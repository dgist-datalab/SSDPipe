========================================
              Arguments
acc_plot: False
ae_compress_rate: 16
auto_encoder: False
batch_size: 256
device: cuda
epochs: 1000
evaluate: False
fine_tuning: False
freeze: True
freeze_to: 4
gpu: 0
initial_lr: 0.001
loss_plot: False
lr_period: 100
lr_scheduler_patience: 10
lr_threshold: 1e-09
num_class: 970
percent: 87
print_freq: 500
print_freq_val: 200
result: result_7d
resume: result_7d/model_last.pth
tr_step: 0
weight_decay: 0.0005
workers: 16
========================================
loaded result_7d/model_last.pth, epoch 3
Freezing all params, insert AE...
[TRAIN 0/1000][0/4227], loss: 0.74933 (avg: 0.74933), lr: 0.0010000000
[TRAIN 0/1000][500/4227], loss: 0.78192 (avg: 0.83515), lr: 0.0010000000
[TRAIN 0/1000][1000/4227], loss: 0.90063 (avg: 0.83963), lr: 0.0010000000
[TRAIN 0/1000][1500/4227], loss: 0.91826 (avg: 0.84005), lr: 0.0010000000
[TRAIN 0/1000][2000/4227], loss: 0.90084 (avg: 0.83995), lr: 0.0010000000
[TRAIN 0/1000][2500/4227], loss: 0.76905 (avg: 0.84028), lr: 0.0010000000
[TRAIN 0/1000][3000/4227], loss: 0.79799 (avg: 0.83946), lr: 0.0010000000
[TRAIN 0/1000][3500/4227], loss: 0.87458 (avg: 0.83865), lr: 0.0010000000
[TRAIN 0/1000][4000/4227], loss: 0.80121 (avg: 0.83884), lr: 0.0010000000
[TEST 0][0/190], loss: 0.577 (avg: 0.577)
 * Epoch 0 TEST metrics: 0.72169, (best: 0.72169), loss: 1.16091, Top-5 acc: 0.90674
saving best checkpoint (epoch: 0)
[TRAIN 1/1000][0/4227], loss: 0.69611 (avg: 0.69611), lr: 0.0009997533
[TRAIN 1/1000][500/4227], loss: 0.81638 (avg: 0.83970), lr: 0.0009997533
[TRAIN 1/1000][1000/4227], loss: 0.71620 (avg: 0.84216), lr: 0.0009997533
[TRAIN 1/1000][1500/4227], loss: 0.76877 (avg: 0.83991), lr: 0.0009997533
[TRAIN 1/1000][2000/4227], loss: 0.84345 (avg: 0.83931), lr: 0.0009997533
[TRAIN 1/1000][2500/4227], loss: 0.84168 (avg: 0.83923), lr: 0.0009997533
[TRAIN 1/1000][3000/4227], loss: 0.85646 (avg: 0.83897), lr: 0.0009997533
[TRAIN 1/1000][3500/4227], loss: 0.83349 (avg: 0.83942), lr: 0.0009997533
[TRAIN 1/1000][4000/4227], loss: 0.72201 (avg: 0.83938), lr: 0.0009997533
[TEST 1][0/190], loss: 0.567 (avg: 0.567)
 * Epoch 1 TEST metrics: 0.72185, (best: 0.72169), loss: 1.15999, Top-5 acc: 0.90756
saving best checkpoint (epoch: 1)
[TRAIN 2/1000][0/4227], loss: 0.71009 (avg: 0.71009), lr: 0.0009990134
[TRAIN 2/1000][500/4227], loss: 0.80913 (avg: 0.83610), lr: 0.0009990134
[TRAIN 2/1000][1000/4227], loss: 0.89248 (avg: 0.83795), lr: 0.0009990134
[TRAIN 2/1000][1500/4227], loss: 0.80256 (avg: 0.83735), lr: 0.0009990134
[TRAIN 2/1000][2000/4227], loss: 0.77386 (avg: 0.83757), lr: 0.0009990134
[TRAIN 2/1000][2500/4227], loss: 0.96806 (avg: 0.83696), lr: 0.0009990134
[TRAIN 2/1000][3000/4227], loss: 0.97055 (avg: 0.83682), lr: 0.0009990134
[TRAIN 2/1000][3500/4227], loss: 0.89124 (avg: 0.83740), lr: 0.0009990134
[TRAIN 2/1000][4000/4227], loss: 0.88944 (avg: 0.83711), lr: 0.0009990134
[TEST 2][0/190], loss: 0.563 (avg: 0.563)
 * Epoch 2 TEST metrics: 0.72327, (best: 0.72185), loss: 1.15668, Top-5 acc: 0.90750
saving best checkpoint (epoch: 2)
[TRAIN 3/1000][0/4227], loss: 0.94478 (avg: 0.94478), lr: 0.0009977810
[TRAIN 3/1000][500/4227], loss: 0.81909 (avg: 0.83718), lr: 0.0009977810
[TRAIN 3/1000][1000/4227], loss: 0.97949 (avg: 0.83694), lr: 0.0009977810
[TRAIN 3/1000][1500/4227], loss: 0.90361 (avg: 0.83846), lr: 0.0009977810
[TRAIN 3/1000][2000/4227], loss: 0.85816 (avg: 0.83856), lr: 0.0009977810
[TRAIN 3/1000][2500/4227], loss: 0.85758 (avg: 0.83834), lr: 0.0009977810
[TRAIN 3/1000][3000/4227], loss: 0.74750 (avg: 0.83849), lr: 0.0009977810
[TRAIN 3/1000][3500/4227], loss: 0.85665 (avg: 0.83817), lr: 0.0009977810
[TRAIN 3/1000][4000/4227], loss: 0.79019 (avg: 0.83848), lr: 0.0009977810
[TEST 3][0/190], loss: 0.588 (avg: 0.588)
 * Epoch 3 TEST metrics: 0.72202, (best: 0.72327), loss: 1.15891, Top-5 acc: 0.90739
[TRAIN 4/1000][0/4227], loss: 0.82410 (avg: 0.82410), lr: 0.0009960574
[TRAIN 4/1000][500/4227], loss: 0.77380 (avg: 0.83770), lr: 0.0009960574
[TRAIN 4/1000][1000/4227], loss: 0.78620 (avg: 0.83933), lr: 0.0009960574
[TRAIN 4/1000][1500/4227], loss: 0.74794 (avg: 0.83849), lr: 0.0009960574
[TRAIN 4/1000][2000/4227], loss: 0.87824 (avg: 0.83779), lr: 0.0009960574
[TRAIN 4/1000][2500/4227], loss: 0.81515 (avg: 0.83717), lr: 0.0009960574
[TRAIN 4/1000][3000/4227], loss: 0.84206 (avg: 0.83750), lr: 0.0009960574
[TRAIN 4/1000][3500/4227], loss: 0.95322 (avg: 0.83735), lr: 0.0009960574
[TRAIN 4/1000][4000/4227], loss: 0.97314 (avg: 0.83786), lr: 0.0009960574
[TEST 4][0/190], loss: 0.550 (avg: 0.550)
 * Epoch 4 TEST metrics: 0.72045, (best: 0.72327), loss: 1.16305, Top-5 acc: 0.90589
[TRAIN 5/1000][0/4227], loss: 1.00853 (avg: 1.00853), lr: 0.0009938442
[TRAIN 5/1000][500/4227], loss: 0.77040 (avg: 0.83674), lr: 0.0009938442
[TRAIN 5/1000][1000/4227], loss: 0.88388 (avg: 0.83555), lr: 0.0009938442
[TRAIN 5/1000][1500/4227], loss: 0.90449 (avg: 0.83398), lr: 0.0009938442
[TRAIN 5/1000][2000/4227], loss: 0.77033 (avg: 0.83670), lr: 0.0009938442
[TRAIN 5/1000][2500/4227], loss: 0.77046 (avg: 0.83704), lr: 0.0009938442
[TRAIN 5/1000][3000/4227], loss: 0.95984 (avg: 0.83697), lr: 0.0009938442
[TRAIN 5/1000][3500/4227], loss: 0.75590 (avg: 0.83694), lr: 0.0009938442
[TRAIN 5/1000][4000/4227], loss: 0.81780 (avg: 0.83708), lr: 0.0009938442
[TEST 5][0/190], loss: 0.606 (avg: 0.606)
 * Epoch 5 TEST metrics: 0.72305, (best: 0.72327), loss: 1.15707, Top-5 acc: 0.90676
[TRAIN 6/1000][0/4227], loss: 0.83301 (avg: 0.83301), lr: 0.0009911437
[TRAIN 6/1000][500/4227], loss: 0.73457 (avg: 0.84447), lr: 0.0009911437
[TRAIN 6/1000][1000/4227], loss: 0.90880 (avg: 0.83746), lr: 0.0009911437
[TRAIN 6/1000][1500/4227], loss: 0.93637 (avg: 0.83707), lr: 0.0009911437
[TRAIN 6/1000][2000/4227], loss: 1.04151 (avg: 0.83954), lr: 0.0009911437
[TRAIN 6/1000][2500/4227], loss: 1.03999 (avg: 0.83692), lr: 0.0009911437
[TRAIN 6/1000][3000/4227], loss: 0.81200 (avg: 0.83634), lr: 0.0009911437
[TRAIN 6/1000][3500/4227], loss: 0.88921 (avg: 0.83618), lr: 0.0009911437
[TRAIN 6/1000][4000/4227], loss: 0.76055 (avg: 0.83668), lr: 0.0009911437
[TEST 6][0/190], loss: 0.541 (avg: 0.541)
 * Epoch 6 TEST metrics: 0.72175, (best: 0.72327), loss: 1.15954, Top-5 acc: 0.90622
[TRAIN 7/1000][0/4227], loss: 0.85345 (avg: 0.85345), lr: 0.0009879585
[TRAIN 7/1000][500/4227], loss: 0.71272 (avg: 0.84097), lr: 0.0009879585
[TRAIN 7/1000][1000/4227], loss: 0.76530 (avg: 0.83714), lr: 0.0009879585
[TRAIN 7/1000][1500/4227], loss: 0.80164 (avg: 0.83726), lr: 0.0009879585
[TRAIN 7/1000][2000/4227], loss: 0.83119 (avg: 0.83589), lr: 0.0009879585
[TRAIN 7/1000][2500/4227], loss: 0.91279 (avg: 0.83786), lr: 0.0009879585
[TRAIN 7/1000][3000/4227], loss: 0.84590 (avg: 0.83860), lr: 0.0009879585
[TRAIN 7/1000][3500/4227], loss: 1.05482 (avg: 0.83753), lr: 0.0009879585
[TRAIN 7/1000][4000/4227], loss: 0.72057 (avg: 0.83749), lr: 0.0009879585
[TEST 7][0/190], loss: 0.560 (avg: 0.560)
 * Epoch 7 TEST metrics: 0.72049, (best: 0.72327), loss: 1.16454, Top-5 acc: 0.90610
[TRAIN 8/1000][0/4227], loss: 0.89648 (avg: 0.89648), lr: 0.0009842917
[TRAIN 8/1000][500/4227], loss: 0.81797 (avg: 0.83229), lr: 0.0009842917
[TRAIN 8/1000][1000/4227], loss: 0.83739 (avg: 0.83499), lr: 0.0009842917
[TRAIN 8/1000][1500/4227], loss: 0.79873 (avg: 0.83707), lr: 0.0009842917
[TRAIN 8/1000][2000/4227], loss: 0.70666 (avg: 0.83767), lr: 0.0009842917
[TRAIN 8/1000][2500/4227], loss: 0.81788 (avg: 0.83808), lr: 0.0009842917
[TRAIN 8/1000][3000/4227], loss: 0.59532 (avg: 0.83680), lr: 0.0009842917
[TRAIN 8/1000][3500/4227], loss: 0.79585 (avg: 0.83659), lr: 0.0009842917
[TRAIN 8/1000][4000/4227], loss: 0.82875 (avg: 0.83625), lr: 0.0009842917
[TEST 8][0/190], loss: 0.543 (avg: 0.543)
 * Epoch 8 TEST metrics: 0.72241, (best: 0.72327), loss: 1.16267, Top-5 acc: 0.90597
[TRAIN 9/1000][0/4227], loss: 0.77254 (avg: 0.77254), lr: 0.0009801470
[TRAIN 9/1000][500/4227], loss: 0.87692 (avg: 0.83524), lr: 0.0009801470
[TRAIN 9/1000][1000/4227], loss: 0.98396 (avg: 0.84120), lr: 0.0009801470
[TRAIN 9/1000][1500/4227], loss: 0.83038 (avg: 0.83912), lr: 0.0009801470
[TRAIN 9/1000][2000/4227], loss: 0.92907 (avg: 0.83706), lr: 0.0009801470
[TRAIN 9/1000][2500/4227], loss: 0.91353 (avg: 0.83597), lr: 0.0009801470
[TRAIN 9/1000][3000/4227], loss: 0.85878 (avg: 0.83524), lr: 0.0009801470
[TRAIN 9/1000][3500/4227], loss: 0.96134 (avg: 0.83602), lr: 0.0009801470
[TRAIN 9/1000][4000/4227], loss: 0.78529 (avg: 0.83521), lr: 0.0009801470
[TEST 9][0/190], loss: 0.567 (avg: 0.567)
 * Epoch 9 TEST metrics: 0.72257, (best: 0.72327), loss: 1.16006, Top-5 acc: 0.90612
There is nearly no performance update, Reduce lr by a half!(epoch: 10)
[TRAIN 10/1000][0/4227], loss: 0.69934 (avg: 0.69934), lr: 0.0002926586
[TRAIN 10/1000][500/4227], loss: 0.77579 (avg: 0.83674), lr: 0.0002926586
[TRAIN 10/1000][1000/4227], loss: 0.72762 (avg: 0.83532), lr: 0.0002926586
[TRAIN 10/1000][1500/4227], loss: 0.78754 (avg: 0.83374), lr: 0.0002926586
[TRAIN 10/1000][2000/4227], loss: 0.80799 (avg: 0.83315), lr: 0.0002926586
[TRAIN 10/1000][2500/4227], loss: 0.79433 (avg: 0.83233), lr: 0.0002926586
[TRAIN 10/1000][3000/4227], loss: 0.93931 (avg: 0.83323), lr: 0.0002926586
[TRAIN 10/1000][3500/4227], loss: 0.80366 (avg: 0.83260), lr: 0.0002926586
[TRAIN 10/1000][4000/4227], loss: 0.79701 (avg: 0.83293), lr: 0.0002926586
[TEST 10][0/190], loss: 0.607 (avg: 0.607)
 * Epoch 10 TEST metrics: 0.72288, (best: 0.72327), loss: 1.15979, Top-5 acc: 0.90628
[TRAIN 11/1000][0/4227], loss: 0.82611 (avg: 0.82611), lr: 0.0002911322
[TRAIN 11/1000][500/4227], loss: 0.77523 (avg: 0.83413), lr: 0.0002911322
[TRAIN 11/1000][1000/4227], loss: 0.83847 (avg: 0.83038), lr: 0.0002911322
[TRAIN 11/1000][1500/4227], loss: 0.72076 (avg: 0.82968), lr: 0.0002911322
[TRAIN 11/1000][2000/4227], loss: 0.82400 (avg: 0.82991), lr: 0.0002911322
[TRAIN 11/1000][2500/4227], loss: 0.84826 (avg: 0.83153), lr: 0.0002911322
[TRAIN 11/1000][3000/4227], loss: 0.83414 (avg: 0.83215), lr: 0.0002911322
[TRAIN 11/1000][3500/4227], loss: 0.79948 (avg: 0.83325), lr: 0.0002911322
[TRAIN 11/1000][4000/4227], loss: 0.81226 (avg: 0.83274), lr: 0.0002911322
[TEST 11][0/190], loss: 0.633 (avg: 0.633)
 * Epoch 11 TEST metrics: 0.72124, (best: 0.72327), loss: 1.15962, Top-5 acc: 0.90630
[TRAIN 12/1000][0/4227], loss: 0.91296 (avg: 0.91296), lr: 0.0002894667
[TRAIN 12/1000][500/4227], loss: 0.93081 (avg: 0.83565), lr: 0.0002894667
[TRAIN 12/1000][1000/4227], loss: 0.86160 (avg: 0.83125), lr: 0.0002894667
[TRAIN 12/1000][1500/4227], loss: 0.76719 (avg: 0.83354), lr: 0.0002894667
[TRAIN 12/1000][2000/4227], loss: 0.65946 (avg: 0.83556), lr: 0.0002894667
[TRAIN 12/1000][2500/4227], loss: 0.90791 (avg: 0.83516), lr: 0.0002894667
[TRAIN 12/1000][3000/4227], loss: 0.89004 (avg: 0.83378), lr: 0.0002894667
[TRAIN 12/1000][3500/4227], loss: 0.90828 (avg: 0.83363), lr: 0.0002894667
[TRAIN 12/1000][4000/4227], loss: 0.88544 (avg: 0.83387), lr: 0.0002894667
[TEST 12][0/190], loss: 0.561 (avg: 0.561)
 * Epoch 12 TEST metrics: 0.72280, (best: 0.72327), loss: 1.15405, Top-5 acc: 0.90737
[TRAIN 13/1000][0/4227], loss: 0.86467 (avg: 0.86467), lr: 0.0002876634
[TRAIN 13/1000][500/4227], loss: 0.65990 (avg: 0.83172), lr: 0.0002876634
[TRAIN 13/1000][1000/4227], loss: 0.86986 (avg: 0.83000), lr: 0.0002876634
[TRAIN 13/1000][1500/4227], loss: 0.97259 (avg: 0.83156), lr: 0.0002876634
[TRAIN 13/1000][2000/4227], loss: 0.71597 (avg: 0.83137), lr: 0.0002876634
[TRAIN 13/1000][2500/4227], loss: 0.82677 (avg: 0.83149), lr: 0.0002876634
[TRAIN 13/1000][3000/4227], loss: 0.90048 (avg: 0.83216), lr: 0.0002876634
[TRAIN 13/1000][3500/4227], loss: 0.97942 (avg: 0.83227), lr: 0.0002876634
[TRAIN 13/1000][4000/4227], loss: 0.77361 (avg: 0.83325), lr: 0.0002876634
[TEST 13][0/190], loss: 0.590 (avg: 0.590)
 * Epoch 13 TEST metrics: 0.72268, (best: 0.72327), loss: 1.15607, Top-5 acc: 0.90667
[TRAIN 14/1000][0/4227], loss: 0.86107 (avg: 0.86107), lr: 0.0002857244
[TRAIN 14/1000][500/4227], loss: 1.02127 (avg: 0.83304), lr: 0.0002857244
[TRAIN 14/1000][1000/4227], loss: 0.79786 (avg: 0.83506), lr: 0.0002857244
[TRAIN 14/1000][1500/4227], loss: 1.02320 (avg: 0.83379), lr: 0.0002857244
[TRAIN 14/1000][2000/4227], loss: 0.72262 (avg: 0.83481), lr: 0.0002857244
[TRAIN 14/1000][2500/4227], loss: 0.85727 (avg: 0.83393), lr: 0.0002857244
[TRAIN 14/1000][3000/4227], loss: 0.86119 (avg: 0.83420), lr: 0.0002857244
[TRAIN 14/1000][3500/4227], loss: 0.75138 (avg: 0.83324), lr: 0.0002857244
[TRAIN 14/1000][4000/4227], loss: 0.89642 (avg: 0.83388), lr: 0.0002857244
[TEST 14][0/190], loss: 0.553 (avg: 0.553)
 * Epoch 14 TEST metrics: 0.72163, (best: 0.72327), loss: 1.15815, Top-5 acc: 0.90632
[TRAIN 15/1000][0/4227], loss: 0.77630 (avg: 0.77630), lr: 0.0002836514
[TRAIN 15/1000][500/4227], loss: 0.74218 (avg: 0.82443), lr: 0.0002836514
[TRAIN 15/1000][1000/4227], loss: 0.89468 (avg: 0.83079), lr: 0.0002836514
[TRAIN 15/1000][1500/4227], loss: 0.85908 (avg: 0.83216), lr: 0.0002836514
[TRAIN 15/1000][2000/4227], loss: 0.73076 (avg: 0.83146), lr: 0.0002836514
[TRAIN 15/1000][2500/4227], loss: 0.81615 (avg: 0.83128), lr: 0.0002836514
[TRAIN 15/1000][3000/4227], loss: 0.85520 (avg: 0.83240), lr: 0.0002836514
[TRAIN 15/1000][3500/4227], loss: 0.89018 (avg: 0.83245), lr: 0.0002836514
[TRAIN 15/1000][4000/4227], loss: 0.80044 (avg: 0.83188), lr: 0.0002836514
[TEST 15][0/190], loss: 0.543 (avg: 0.543)
 * Epoch 15 TEST metrics: 0.72278, (best: 0.72327), loss: 1.15987, Top-5 acc: 0.90665
[TRAIN 16/1000][0/4227], loss: 0.83680 (avg: 0.83680), lr: 0.0002814465
[TRAIN 16/1000][500/4227], loss: 0.93139 (avg: 0.82409), lr: 0.0002814465
[TRAIN 16/1000][1000/4227], loss: 0.85868 (avg: 0.82475), lr: 0.0002814465
[TRAIN 16/1000][1500/4227], loss: 0.89135 (avg: 0.82734), lr: 0.0002814465
[TRAIN 16/1000][2000/4227], loss: 0.91471 (avg: 0.82872), lr: 0.0002814465
[TRAIN 16/1000][2500/4227], loss: 0.67916 (avg: 0.83013), lr: 0.0002814465
[TRAIN 16/1000][3000/4227], loss: 0.80931 (avg: 0.83132), lr: 0.0002814465
[TRAIN 16/1000][3500/4227], loss: 0.84449 (avg: 0.83158), lr: 0.0002814465
[TRAIN 16/1000][4000/4227], loss: 1.00090 (avg: 0.83225), lr: 0.0002814465
[TEST 16][0/190], loss: 0.577 (avg: 0.577)
 * Epoch 16 TEST metrics: 0.72282, (best: 0.72327), loss: 1.15811, Top-5 acc: 0.90614
[TRAIN 17/1000][0/4227], loss: 0.72828 (avg: 0.72828), lr: 0.0002791118
