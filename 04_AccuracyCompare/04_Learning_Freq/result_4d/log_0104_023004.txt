========================================
              Arguments
acc_plot: False
ae_compress_rate: 16
auto_encoder: False
batch_size: 256
device: cuda
epochs: 1000
evaluate: False
fine_tuning: False
freeze: True
freeze_to: 4
gpu: 0
initial_lr: 0.001
loss_plot: False
lr_period: 100
lr_scheduler_patience: 10
lr_threshold: 1e-09
num_class: 953
percent: 79
print_freq: 500
print_freq_val: 200
result: result_4d
resume: result_4d/model_last.pth
tr_step: 0
weight_decay: 0.0005
workers: 16
========================================
loaded result_4d/model_last.pth, epoch 3
Freezing all params, insert AE...
[TRAIN 0/1000][0/3771], loss: 0.91013 (avg: 0.91013), lr: 0.0010000000
[TRAIN 0/1000][500/3771], loss: 0.96943 (avg: 0.80727), lr: 0.0010000000
[TRAIN 0/1000][1000/3771], loss: 0.75485 (avg: 0.80788), lr: 0.0010000000
[TRAIN 0/1000][1500/3771], loss: 0.84856 (avg: 0.80972), lr: 0.0010000000
[TRAIN 0/1000][2000/3771], loss: 0.75657 (avg: 0.80830), lr: 0.0010000000
[TRAIN 0/1000][2500/3771], loss: 0.98510 (avg: 0.80758), lr: 0.0010000000
[TRAIN 0/1000][3000/3771], loss: 0.92050 (avg: 0.80802), lr: 0.0010000000
[TRAIN 0/1000][3500/3771], loss: 0.72131 (avg: 0.80842), lr: 0.0010000000
[TEST 0][0/187], loss: 0.582 (avg: 0.582)
 * Epoch 0 TEST metrics: 0.72893, (best: 0.72893), loss: 1.12947, Top-5 acc: 0.90996
saving best checkpoint (epoch: 0)
[TRAIN 1/1000][0/3771], loss: 0.84758 (avg: 0.84758), lr: 0.0009997533
[TRAIN 1/1000][500/3771], loss: 0.84883 (avg: 0.80451), lr: 0.0009997533
[TRAIN 1/1000][1000/3771], loss: 0.92196 (avg: 0.80452), lr: 0.0009997533
[TRAIN 1/1000][1500/3771], loss: 0.82789 (avg: 0.80549), lr: 0.0009997533
[TRAIN 1/1000][2000/3771], loss: 0.75730 (avg: 0.80399), lr: 0.0009997533
[TRAIN 1/1000][2500/3771], loss: 0.98851 (avg: 0.80691), lr: 0.0009997533
[TRAIN 1/1000][3000/3771], loss: 0.85234 (avg: 0.80753), lr: 0.0009997533
[TRAIN 1/1000][3500/3771], loss: 0.80117 (avg: 0.80802), lr: 0.0009997533
[TEST 1][0/187], loss: 0.561 (avg: 0.561)
 * Epoch 1 TEST metrics: 0.72912, (best: 0.72893), loss: 1.13319, Top-5 acc: 0.91050
saving best checkpoint (epoch: 1)
[TRAIN 2/1000][0/3771], loss: 0.84493 (avg: 0.84493), lr: 0.0009990134
[TRAIN 2/1000][500/3771], loss: 0.81067 (avg: 0.81049), lr: 0.0009990134
[TRAIN 2/1000][1000/3771], loss: 0.83534 (avg: 0.80892), lr: 0.0009990134
[TRAIN 2/1000][1500/3771], loss: 0.95030 (avg: 0.80826), lr: 0.0009990134
[TRAIN 2/1000][2000/3771], loss: 0.66732 (avg: 0.80581), lr: 0.0009990134
[TRAIN 2/1000][2500/3771], loss: 0.84102 (avg: 0.80606), lr: 0.0009990134
[TRAIN 2/1000][3000/3771], loss: 0.67594 (avg: 0.80635), lr: 0.0009990134
[TRAIN 2/1000][3500/3771], loss: 0.82286 (avg: 0.80776), lr: 0.0009990134
[TEST 2][0/187], loss: 0.564 (avg: 0.564)
 * Epoch 2 TEST metrics: 0.72843, (best: 0.72912), loss: 1.12980, Top-5 acc: 0.91161
[TRAIN 3/1000][0/3771], loss: 0.70047 (avg: 0.70047), lr: 0.0009977810
[TRAIN 3/1000][500/3771], loss: 0.86246 (avg: 0.81281), lr: 0.0009977810
[TRAIN 3/1000][1000/3771], loss: 0.74358 (avg: 0.80729), lr: 0.0009977810
[TRAIN 3/1000][1500/3771], loss: 0.84793 (avg: 0.80673), lr: 0.0009977810
[TRAIN 3/1000][2000/3771], loss: 0.80487 (avg: 0.80769), lr: 0.0009977810
[TRAIN 3/1000][2500/3771], loss: 0.65870 (avg: 0.80608), lr: 0.0009977810
[TRAIN 3/1000][3000/3771], loss: 0.93784 (avg: 0.80599), lr: 0.0009977810
[TRAIN 3/1000][3500/3771], loss: 0.72262 (avg: 0.80604), lr: 0.0009977810
[TEST 3][0/187], loss: 0.570 (avg: 0.570)
 * Epoch 3 TEST metrics: 0.72914, (best: 0.72912), loss: 1.13078, Top-5 acc: 0.91048
saving best checkpoint (epoch: 3)
[TRAIN 4/1000][0/3771], loss: 0.75882 (avg: 0.75882), lr: 0.0009960574
[TRAIN 4/1000][500/3771], loss: 0.77574 (avg: 0.80055), lr: 0.0009960574
[TRAIN 4/1000][1000/3771], loss: 0.89774 (avg: 0.80162), lr: 0.0009960574
[TRAIN 4/1000][1500/3771], loss: 0.72043 (avg: 0.80514), lr: 0.0009960574
[TRAIN 4/1000][2000/3771], loss: 0.70371 (avg: 0.80467), lr: 0.0009960574
[TRAIN 4/1000][2500/3771], loss: 0.89370 (avg: 0.80508), lr: 0.0009960574
[TRAIN 4/1000][3000/3771], loss: 0.79811 (avg: 0.80573), lr: 0.0009960574
[TRAIN 4/1000][3500/3771], loss: 0.87400 (avg: 0.80445), lr: 0.0009960574
[TEST 4][0/187], loss: 0.567 (avg: 0.567)
 * Epoch 4 TEST metrics: 0.72776, (best: 0.72914), loss: 1.12960, Top-5 acc: 0.91057
[TRAIN 5/1000][0/3771], loss: 0.91973 (avg: 0.91973), lr: 0.0009938442
[TRAIN 5/1000][500/3771], loss: 0.83134 (avg: 0.80710), lr: 0.0009938442
[TRAIN 5/1000][1000/3771], loss: 0.85009 (avg: 0.81150), lr: 0.0009938442
[TRAIN 5/1000][1500/3771], loss: 0.76370 (avg: 0.80885), lr: 0.0009938442
[TRAIN 5/1000][2000/3771], loss: 0.68590 (avg: 0.80903), lr: 0.0009938442
[TRAIN 5/1000][2500/3771], loss: 0.88621 (avg: 0.80780), lr: 0.0009938442
[TRAIN 5/1000][3000/3771], loss: 0.90820 (avg: 0.80553), lr: 0.0009938442
[TRAIN 5/1000][3500/3771], loss: 0.89330 (avg: 0.80577), lr: 0.0009938442
[TEST 5][0/187], loss: 0.607 (avg: 0.607)
 * Epoch 5 TEST metrics: 0.72874, (best: 0.72914), loss: 1.12910, Top-5 acc: 0.91069
[TRAIN 6/1000][0/3771], loss: 0.84279 (avg: 0.84279), lr: 0.0009911437
[TRAIN 6/1000][500/3771], loss: 0.82284 (avg: 0.80317), lr: 0.0009911437
[TRAIN 6/1000][1000/3771], loss: 0.77416 (avg: 0.80652), lr: 0.0009911437
[TRAIN 6/1000][1500/3771], loss: 0.78733 (avg: 0.80568), lr: 0.0009911437
[TRAIN 6/1000][2000/3771], loss: 0.83349 (avg: 0.80563), lr: 0.0009911437
[TRAIN 6/1000][2500/3771], loss: 0.92626 (avg: 0.80609), lr: 0.0009911437
[TRAIN 6/1000][3000/3771], loss: 0.60768 (avg: 0.80645), lr: 0.0009911437
[TRAIN 6/1000][3500/3771], loss: 0.86502 (avg: 0.80601), lr: 0.0009911437
[TEST 6][0/187], loss: 0.568 (avg: 0.568)
 * Epoch 6 TEST metrics: 0.72736, (best: 0.72914), loss: 1.13580, Top-5 acc: 0.90954
[TRAIN 7/1000][0/3771], loss: 0.80869 (avg: 0.80869), lr: 0.0009879585
[TRAIN 7/1000][500/3771], loss: 0.85916 (avg: 0.80157), lr: 0.0009879585
[TRAIN 7/1000][1000/3771], loss: 0.76179 (avg: 0.80274), lr: 0.0009879585
[TRAIN 7/1000][1500/3771], loss: 0.77967 (avg: 0.80385), lr: 0.0009879585
[TRAIN 7/1000][2000/3771], loss: 0.87490 (avg: 0.80498), lr: 0.0009879585
[TRAIN 7/1000][2500/3771], loss: 0.69784 (avg: 0.80424), lr: 0.0009879585
[TRAIN 7/1000][3000/3771], loss: 0.80198 (avg: 0.80408), lr: 0.0009879585
[TRAIN 7/1000][3500/3771], loss: 0.77365 (avg: 0.80366), lr: 0.0009879585
[TEST 7][0/187], loss: 0.609 (avg: 0.609)
 * Epoch 7 TEST metrics: 0.72960, (best: 0.72914), loss: 1.12899, Top-5 acc: 0.91113
saving best checkpoint (epoch: 7)
[TRAIN 8/1000][0/3771], loss: 0.76333 (avg: 0.76333), lr: 0.0009842917
[TRAIN 8/1000][500/3771], loss: 0.69223 (avg: 0.80441), lr: 0.0009842917
[TRAIN 8/1000][1000/3771], loss: 0.83832 (avg: 0.80427), lr: 0.0009842917
[TRAIN 8/1000][1500/3771], loss: 0.75820 (avg: 0.80428), lr: 0.0009842917
[TRAIN 8/1000][2000/3771], loss: 0.83500 (avg: 0.80644), lr: 0.0009842917
[TRAIN 8/1000][2500/3771], loss: 0.89262 (avg: 0.80586), lr: 0.0009842917
[TRAIN 8/1000][3000/3771], loss: 0.73587 (avg: 0.80474), lr: 0.0009842917
[TRAIN 8/1000][3500/3771], loss: 0.72148 (avg: 0.80483), lr: 0.0009842917
[TEST 8][0/187], loss: 0.572 (avg: 0.572)
 * Epoch 8 TEST metrics: 0.72885, (best: 0.72960), loss: 1.13436, Top-5 acc: 0.91046
[TRAIN 9/1000][0/3771], loss: 1.04176 (avg: 1.04176), lr: 0.0009801470
[TRAIN 9/1000][500/3771], loss: 0.62276 (avg: 0.80558), lr: 0.0009801470
[TRAIN 9/1000][1000/3771], loss: 0.72107 (avg: 0.80165), lr: 0.0009801470
[TRAIN 9/1000][1500/3771], loss: 0.92873 (avg: 0.80239), lr: 0.0009801470
[TRAIN 9/1000][2000/3771], loss: 0.76155 (avg: 0.80369), lr: 0.0009801470
[TRAIN 9/1000][2500/3771], loss: 0.72053 (avg: 0.80365), lr: 0.0009801470
[TRAIN 9/1000][3000/3771], loss: 0.86604 (avg: 0.80267), lr: 0.0009801470
[TRAIN 9/1000][3500/3771], loss: 0.79976 (avg: 0.80318), lr: 0.0009801470
[TEST 9][0/187], loss: 0.583 (avg: 0.583)
 * Epoch 9 TEST metrics: 0.72761, (best: 0.72960), loss: 1.13405, Top-5 acc: 0.90973
There is nearly no performance update, Reduce lr by a half!(epoch: 10)
[TRAIN 10/1000][0/3771], loss: 0.70853 (avg: 0.70853), lr: 0.0002926586
[TRAIN 10/1000][500/3771], loss: 0.75614 (avg: 0.79862), lr: 0.0002926586
[TRAIN 10/1000][1000/3771], loss: 0.81705 (avg: 0.80166), lr: 0.0002926586
[TRAIN 10/1000][1500/3771], loss: 0.70974 (avg: 0.80493), lr: 0.0002926586
[TRAIN 10/1000][2000/3771], loss: 0.75898 (avg: 0.80619), lr: 0.0002926586
[TRAIN 10/1000][2500/3771], loss: 0.88875 (avg: 0.80408), lr: 0.0002926586
[TRAIN 10/1000][3000/3771], loss: 0.83447 (avg: 0.80415), lr: 0.0002926586
[TRAIN 10/1000][3500/3771], loss: 1.02801 (avg: 0.80458), lr: 0.0002926586
[TEST 10][0/187], loss: 0.581 (avg: 0.581)
 * Epoch 10 TEST metrics: 0.72834, (best: 0.72960), loss: 1.13242, Top-5 acc: 0.91046
[TRAIN 11/1000][0/3771], loss: 0.84349 (avg: 0.84349), lr: 0.0002911322
[TRAIN 11/1000][500/3771], loss: 0.72550 (avg: 0.81067), lr: 0.0002911322
[TRAIN 11/1000][1000/3771], loss: 0.64272 (avg: 0.80527), lr: 0.0002911322
[TRAIN 11/1000][1500/3771], loss: 0.81115 (avg: 0.80286), lr: 0.0002911322
[TRAIN 11/1000][2000/3771], loss: 0.86279 (avg: 0.80277), lr: 0.0002911322
[TRAIN 11/1000][2500/3771], loss: 0.87090 (avg: 0.80234), lr: 0.0002911322
[TRAIN 11/1000][3000/3771], loss: 0.70546 (avg: 0.80200), lr: 0.0002911322
[TRAIN 11/1000][3500/3771], loss: 0.86859 (avg: 0.80199), lr: 0.0002911322
[TEST 11][0/187], loss: 0.565 (avg: 0.565)
 * Epoch 11 TEST metrics: 0.72866, (best: 0.72960), loss: 1.13051, Top-5 acc: 0.91042
[TRAIN 12/1000][0/3771], loss: 0.92207 (avg: 0.92207), lr: 0.0002894667
[TRAIN 12/1000][500/3771], loss: 0.82217 (avg: 0.81008), lr: 0.0002894667
[TRAIN 12/1000][1000/3771], loss: 0.76652 (avg: 0.80453), lr: 0.0002894667
[TRAIN 12/1000][1500/3771], loss: 0.82018 (avg: 0.80209), lr: 0.0002894667
[TRAIN 12/1000][2000/3771], loss: 0.62861 (avg: 0.80110), lr: 0.0002894667
[TRAIN 12/1000][2500/3771], loss: 0.77929 (avg: 0.80140), lr: 0.0002894667
[TRAIN 12/1000][3000/3771], loss: 0.77239 (avg: 0.80207), lr: 0.0002894667
[TRAIN 12/1000][3500/3771], loss: 0.70653 (avg: 0.80246), lr: 0.0002894667
[TEST 12][0/187], loss: 0.605 (avg: 0.605)
 * Epoch 12 TEST metrics: 0.72920, (best: 0.72960), loss: 1.12968, Top-5 acc: 0.90981
[TRAIN 13/1000][0/3771], loss: 0.89106 (avg: 0.89106), lr: 0.0002876634
[TRAIN 13/1000][500/3771], loss: 0.75451 (avg: 0.80076), lr: 0.0002876634
[TRAIN 13/1000][1000/3771], loss: 0.94318 (avg: 0.80113), lr: 0.0002876634
[TRAIN 13/1000][1500/3771], loss: 0.76775 (avg: 0.80104), lr: 0.0002876634
[TRAIN 13/1000][2000/3771], loss: 0.82817 (avg: 0.80259), lr: 0.0002876634
[TRAIN 13/1000][2500/3771], loss: 0.96733 (avg: 0.80349), lr: 0.0002876634
[TRAIN 13/1000][3000/3771], loss: 0.89169 (avg: 0.80352), lr: 0.0002876634
[TRAIN 13/1000][3500/3771], loss: 0.85418 (avg: 0.80345), lr: 0.0002876634
[TEST 13][0/187], loss: 0.561 (avg: 0.561)
 * Epoch 13 TEST metrics: 0.72937, (best: 0.72960), loss: 1.12944, Top-5 acc: 0.91031
[TRAIN 14/1000][0/3771], loss: 0.98821 (avg: 0.98821), lr: 0.0002857244
[TRAIN 14/1000][500/3771], loss: 0.82066 (avg: 0.80063), lr: 0.0002857244
[TRAIN 14/1000][1000/3771], loss: 0.84256 (avg: 0.80251), lr: 0.0002857244
[TRAIN 14/1000][1500/3771], loss: 0.75713 (avg: 0.80231), lr: 0.0002857244
[TRAIN 14/1000][2000/3771], loss: 0.61011 (avg: 0.80240), lr: 0.0002857244
[TRAIN 14/1000][2500/3771], loss: 0.71535 (avg: 0.80291), lr: 0.0002857244
[TRAIN 14/1000][3000/3771], loss: 0.59951 (avg: 0.80157), lr: 0.0002857244
[TRAIN 14/1000][3500/3771], loss: 0.78722 (avg: 0.80154), lr: 0.0002857244
[TEST 14][0/187], loss: 0.551 (avg: 0.551)
 * Epoch 14 TEST metrics: 0.73055, (best: 0.72960), loss: 1.12544, Top-5 acc: 0.91082
saving best checkpoint (epoch: 14)
[TRAIN 15/1000][0/3771], loss: 0.72803 (avg: 0.72803), lr: 0.0002836514
[TRAIN 15/1000][500/3771], loss: 0.81788 (avg: 0.80297), lr: 0.0002836514
[TRAIN 15/1000][1000/3771], loss: 0.91149 (avg: 0.80265), lr: 0.0002836514
[TRAIN 15/1000][1500/3771], loss: 0.86286 (avg: 0.80368), lr: 0.0002836514
[TRAIN 15/1000][2000/3771], loss: 0.82540 (avg: 0.80396), lr: 0.0002836514
[TRAIN 15/1000][2500/3771], loss: 0.69316 (avg: 0.80270), lr: 0.0002836514
[TRAIN 15/1000][3000/3771], loss: 0.69351 (avg: 0.80304), lr: 0.0002836514
[TRAIN 15/1000][3500/3771], loss: 0.90174 (avg: 0.80282), lr: 0.0002836514
[TEST 15][0/187], loss: 0.573 (avg: 0.573)
 * Epoch 15 TEST metrics: 0.72945, (best: 0.73055), loss: 1.13183, Top-5 acc: 0.91090
[TRAIN 16/1000][0/3771], loss: 0.77057 (avg: 0.77057), lr: 0.0002814465
[TRAIN 16/1000][500/3771], loss: 1.02104 (avg: 0.80602), lr: 0.0002814465
[TRAIN 16/1000][1000/3771], loss: 0.72556 (avg: 0.80633), lr: 0.0002814465
[TRAIN 16/1000][1500/3771], loss: 0.81611 (avg: 0.80197), lr: 0.0002814465
[TRAIN 16/1000][2000/3771], loss: 0.77706 (avg: 0.80221), lr: 0.0002814465
[TRAIN 16/1000][2500/3771], loss: 0.82659 (avg: 0.80232), lr: 0.0002814465
[TRAIN 16/1000][3000/3771], loss: 0.77779 (avg: 0.80282), lr: 0.0002814465
[TRAIN 16/1000][3500/3771], loss: 0.69132 (avg: 0.80259), lr: 0.0002814465
[TEST 16][0/187], loss: 0.585 (avg: 0.585)
 * Epoch 16 TEST metrics: 0.72887, (best: 0.73055), loss: 1.13254, Top-5 acc: 0.90966
[TRAIN 17/1000][0/3771], loss: 0.76973 (avg: 0.76973), lr: 0.0002791118
[TRAIN 17/1000][500/3771], loss: 0.92363 (avg: 0.80529), lr: 0.0002791118
[TRAIN 17/1000][1000/3771], loss: 0.75374 (avg: 0.80042), lr: 0.0002791118
[TRAIN 17/1000][1500/3771], loss: 0.89218 (avg: 0.80141), lr: 0.0002791118
[TRAIN 17/1000][2000/3771], loss: 0.82240 (avg: 0.80133), lr: 0.0002791118
[TRAIN 17/1000][2500/3771], loss: 0.75754 (avg: 0.80201), lr: 0.0002791118
[TRAIN 17/1000][3000/3771], loss: 0.72255 (avg: 0.80298), lr: 0.0002791118
[TRAIN 17/1000][3500/3771], loss: 0.87026 (avg: 0.80197), lr: 0.0002791118
[TEST 17][0/187], loss: 0.596 (avg: 0.596)
 * Epoch 17 TEST metrics: 0.72822, (best: 0.73055), loss: 1.13031, Top-5 acc: 0.91052
[TRAIN 18/1000][0/3771], loss: 0.64937 (avg: 0.64937), lr: 0.0002766498
[TRAIN 18/1000][500/3771], loss: 0.59625 (avg: 0.80266), lr: 0.0002766498
[TRAIN 18/1000][1000/3771], loss: 0.91301 (avg: 0.80106), lr: 0.0002766498
[TRAIN 18/1000][1500/3771], loss: 0.72089 (avg: 0.79998), lr: 0.0002766498
[TRAIN 18/1000][2000/3771], loss: 0.80930 (avg: 0.80246), lr: 0.0002766498
[TRAIN 18/1000][2500/3771], loss: 0.63302 (avg: 0.80149), lr: 0.0002766498
[TRAIN 18/1000][3000/3771], loss: 0.79719 (avg: 0.80215), lr: 0.0002766498
[TRAIN 18/1000][3500/3771], loss: 0.67694 (avg: 0.80218), lr: 0.0002766498
[TEST 18][0/187], loss: 0.580 (avg: 0.580)
 * Epoch 18 TEST metrics: 0.72769, (best: 0.73055), loss: 1.13379, Top-5 acc: 0.90939
[TRAIN 19/1000][0/3771], loss: 0.83170 (avg: 0.83170), lr: 0.0002740628
[TRAIN 19/1000][500/3771], loss: 0.71243 (avg: 0.80123), lr: 0.0002740628
[TRAIN 19/1000][1000/3771], loss: 0.76856 (avg: 0.80202), lr: 0.0002740628
[TRAIN 19/1000][1500/3771], loss: 0.79239 (avg: 0.80281), lr: 0.0002740628
